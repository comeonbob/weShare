<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="share and grow up"><title>移动端web页面适配小结 | We Share</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.1"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">移动端web页面适配小结</h1><a id="logo" href="/.">We Share</a><p class="description">Youyu Esop Team's Blog</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">移动端web页面适配小结</h1><div class="post-meta">Aug 9, 2018<span> | </span><span class="category"><a href="/categories/Xiaobu/">Xiaobu</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><!-- span.post-meta-item-text= " 字数统计："--><span class="post-count"> 4.6k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time">&nbsp; | &nbsp;<span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><!-- span.post-meta-item-text= " 阅读时长："--><span class="post-count"> 18</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" href="/mobile-adaptation/#vcomment"><span class="valine-comment-count" data-xid="/mobile-adaptation/"></span><span> 条评论</span></a><div class="post-content"><blockquote>
<p><em>适配的目标：在不同尺寸的手机设备上，页面“相对性的达到合理的展示（自适应）”或者“保持统一效果的等比缩放（看起来差不多，但不是完全等比例，对于字体我们并不喜欢等比例的去放缩）”。</em></p>
</blockquote>
<p><strong>问题</strong>:手机设备的尺寸不同，让页面在不同的手机设备上显示的效果看起来大致相同或者展示效果比较合理就成了一个问题。 目前移动端比较通用的几个方案</p>
<ul>
<li>媒体查询和rem 适配</li>
<li>viewport 缩放,， rem 布局，js计算</li>
<li>vw适配方案（以后可能的方案）</li>
</ul>
<h2 id="⒈关于viewport"><a href="#⒈关于viewport" class="headerlink" title="⒈关于viewport"></a>⒈关于viewport</h2><p>​知道了通用方法进入代码的正题，写一个如图简单的HTML页面，在Chrome浏览器iPhone6模拟器下调试发现页面的可视区域宽为980px。</p>
<p><img src="/img/h5adaptat/2018-07-25_233254.png" alt=""></p>
<p>为啥是980px了？<strong>默认的</strong>。浏览器厂商为了让那些传统的为桌面浏览器设计的网站在小屏幕下也能够很好显示，所以把<strong>布局视口（layout viewport）</strong>宽度设置地很大，一般在768px ~ 1024px之间，最常见的宽度是980px。哪为啥980px布局宽，能在375px屏幕宽的设备下完好显示了？</p>
<p>因为缩小。</p>
<blockquote>
<p>Narrow screen devices (e.g. mobiles) render pages in a virtual window or viewport, which is usually wider than the screen, and then shrink the rendered result down so it can all be seen at once. Users can then pan and zoom to see different areas of the page. For example, if a mobile screen has a width of 640px, pages might be rendered with a virtual viewport of 980px, and then it will be shrunk down to fit into the 640px space. This is done because many pages are not mobile optimized, and break (or at least look bad) when rendered at a small viewport width. This <strong>virtual viewport</strong> is a way to make non-mobile-optimized sites in general look better on narrow screen devices. (<a href="https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag" target="_blank" rel="noopener">Using the viewport meta tag to control layout on mobile browsers</a>)</p>
</blockquote>
<p>窄屏幕设备（例如移动设备）在<strong>虚拟窗口</strong>或视口中渲染页面，该窗口或视口通常比屏幕宽，然后缩小渲染结果，以便可以立即看到它们。例如，如果移动屏幕的宽度为640px，则可能使用980px的虚拟视口渲染页面，然后缩小页面以适应640px空间。 这样做是因为许多页面不是移动优化的，<strong>并且在以小视口宽度渲染时会中断（或者至少看起来很糟糕）</strong>。 此虚拟视口是一种使非移动优化网站在窄屏设备上看起来更好的方法。虽然已经很人性化的设计了，但如下图不通过用户缩放和横向滚动滚动条，还是很难看清楚页面内容的。</p>
<p><img src="/img/h5adaptat/2018-08-02_024849.png" alt=""></p>
<h3 id="1-1ppk的-关于三个viewport的理论"><a href="#1-1ppk的-关于三个viewport的理论" class="headerlink" title="1.1ppk的 关于三个viewport的理论"></a>1.1ppk的 关于三个viewport的理论</h3><p>除了上文中大概提到的 <strong>layout viewport</strong>， <strong>virtual viewport</strong>，还有<strong>ideal viewport。</strong></p>
<ul>
<li><strong>layout viewport</strong>：布局视口，在呈现页面之前，浏览器需要知道布局视口的宽度,<strong>如没有任何进一步的说明（如设置&lt;meta name=”viewport” content=”width=800”&gt;），浏览器自己选择宽度</strong>。浏览器选择了布局视口的尺寸，使其在完全缩小模式下完全覆盖屏幕。</li>
<li><strong>virtual viewport</strong>：可见视口，可视视口是当前在屏幕上显示的页面的部分。用户可以缩放以更改可视视口的大小。</li>
<li><strong>ideal viewport</strong>：理想的视口，它提供了设备上理想的网页大小。因此，理想视口的尺寸因设备而异。（ideal viewport 的意义在于，无论在何种分辨率的屏幕下，针对ideal viewport 而设计的网站，不需要手动缩放和横向滚动条都可以完美地呈现给用户）</li>
</ul>
<p><img src="/img/h5adaptat/viewport.jpg" alt="&#x56FE;&#x7247;&#x6765;&#x6E90;&#x4E8E;&#x7F51;&#x7EDC;Enter a caption for this image \(optional\)"></p>
<p><strong>layout viewport 和 virtual viewport</strong>的关系用下文的话来描述再好不过了</p>
<blockquote>
<p>想象一下，布局视口是一个不会改变大小或形状的大图像。现在你有一个较小的框架，通过它你可以看到大图像。小框架周围被不透明材料包围，这些材料遮挡了除大部分图像之外的所有部分的视图。您可以通过框架看到的大图像部分是可视视口。您可以在保持框架的同时远离大图像（缩小）以一次查看整个图像，或者您可以靠近（放大）以仅查看一部分。您也可以更改框架的方向，但大图像（布局视口）的大小和形状永远不会更改。</p>
</blockquote>
<p>这样看来layout viewport， virtual viewport，对移动端浏览器的显示帮助还是不够的(浏览器厂商设置的一个宽度，通过一定的“自由“放缩显示在手机设备上)。现在需要一个基础的宽度设定，然后放缩比例是可控的，然后页面刚好完全显示在屏幕上（是指宽度上）。ppk第三个视口<strong>ideal viewport</strong>,就出现了。</p>
<p>三篇值得一看的文章</p>
<p>①<a href="https://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">A tale of two viewports — part one</a>（Concept: device pixels and CSS pixels，这个例子灰常好）</p>
<p>②<a href="https://www.quirksmode.org/mobile/viewports2.html" target="_blank" rel="noopener">A tale of two viewports — part two</a>,</p>
<p>③<a href="https://www.quirksmode.org/mobile/metaviewport/" target="_blank" rel="noopener">Meta viewport</a></p>
<p><strong>ideal viewport 和 virtual viewport 的关系</strong></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">可视视口宽度=理想视口宽度/缩放系数</span><br><span class="line">缩放系数 =理想视口宽度/可视视口宽度</span><br><span class="line"></span><br><span class="line">简单理解一下，如果理想视口宽度=设备宽度=375px，然后后缩放系数为0.5,计算出可视视口宽度为750px;</span><br><span class="line">如果此时的布局视口刚好等于750px;页面的显示是不是非常完美了（页面再也不是“自由“放缩显示了）</span><br></pre></td></tr></table></figure>
<h3 id="1-2-viewport-meta-tag-的引入"><a href="#1-2-viewport-meta-tag-的引入" class="headerlink" title="1.2 viewport meta tag 的引入"></a>1.2 viewport meta tag 的引入</h3><p>为了更好的控制视口的大小比例，苹果公司在其safari浏览器中引入meta viewport（<a href="https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html" target="_blank" rel="noopener">UsingtheViewport</a>），安卓以及各大浏览器厂商也都纷纷引入。下面这个标签是很多人接触移动端页面都会看到的。那么这个标签做了什么了①将布局视口宽度设置为理想的视口宽度width=device-width，<strong>②根据初始缩放系数和理想视口宽度计算出可是视口，③将布局视口宽度设置为刚刚计算的可视视口宽度（布局视口宽度取②，③计算中值大的）</strong>。 （现在看来，页面的初始布局宽度，以及放缩系数是可控靠谱的了，不容易啊，虽然这个标记被流行的移动浏览器支持，但目前还是草案）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="2-DPR-设备像素-备独立像素"><a href="#2-DPR-设备像素-备独立像素" class="headerlink" title="2.DPR,设备像素,备独立像素"></a>2.DPR,设备像素,备独立像素</h2><p>用如下的标签欢快的按着设计稿，以px为单位写着代码，然后设计师看了效果图就跑来了，这个边框怎么这么粗呀？图标，这个图标怎么看起来这么模糊啊？还有怎么这个图标在这个小屏幕手机上面这么大……</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2-1一些需要的概念"><a href="#2-1一些需要的概念" class="headerlink" title="2.1一些需要的概念"></a>2.1一些需要的概念</h3><p><strong>物理像素(physical pixel)</strong> :一个物理像素是显示器(手机屏幕)上最小的物理显示单元，在操作系统的调度下，每一个物理像素都有自己的颜色值和亮度值。从屏幕在工厂生产出的那天起，它上面物理像素点就固定不变了，单位 pt(同设备像素)。</p>
<p> <strong>设备独立像素:</strong>（又称设备无关像素 Device Independent Pixels 、密度独立性 Density Independent或设备独立像素，简称DIP或DP）是一种物理测量单位，基于计算机控制的坐标系统和抽象像素（虚拟像素），由底层系统的程序使用，转换为物理像素的应用。</p>
<p><strong>css像素</strong>：   CSS像素是一个抽像的单位 ，1个 CSS 像素的大小在不同物理设备上看上去大小总是差不多。（为了保证浏览的一致性）<a href="https://www.w3.org/TR/CSS2/syndata.html#length-units" target="_blank" rel="noopener">关于一些长度单位的介绍</a>（有关于css像素描，图片来源于此）</p>
<p>设备分辨率对像素单元的影响：1px乘1px的区域被低分辨率设备（例如典型的计算机显示器）中的单个点覆盖，而同一区域被16个点覆盖 在更高分辨率的设备（如打印机）中。<strong>在不同的设备之间，1个CSS像素所代表的物理像素是可以变化的。</strong></p>
<p><img src="/img/h5adaptat/pixel2.png" alt=""></p>
<p><strong>DPR:</strong>设备像素比简称为dpr，其定义了物理像素和设备独立像素的对应关系。它的值可以按下面的公式计算得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">设备像素比 ＝ 物理像素 / 设备独立像素</span><br><span class="line"></span><br><span class="line">问题：iphone5 的dpr 是 2 屏幕宽度320px 那么它的设备物理像素宽是多少？（640）</span><br></pre></td></tr></table></figure>
<p>来看看图儿（内容来源<a href="https://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">A tale of two viewports — part one</a>）</p>
<p>①CSS像素与设备像素完全重叠。②CSS像素拉伸，现在一个CSS像素与几个设备像素重叠。③CSS像素开始缩小,一个设备像素现在与几个CSS像素重叠。</p>
<p><img src="/img/h5adaptat/csspixels_100.gif" alt=""></p>
<p><strong>在同样一个设备上，1个CSS像素所代表的物理像素是可以变化的;</strong> </p>
<h3 id="2-2图像模糊的由来，1px边框问题"><a href="#2-2图像模糊的由来，1px边框问题" class="headerlink" title="2.2图像模糊的由来，1px边框问题"></a>2.2图像模糊的由来，1px边框问题</h3><p><strong>位图</strong>：是由像素（Pixel）组成的，像素是位图最小的信息单元，存储在图像栅格中。</p>
<p><strong>图像问题</strong>：理论上，1个位图像素对应于1个物理像素，图片可以完美清晰的展示。一个位图像素是栅格图像(如：png, jpg, gif等)的最小数据单元。在Retina屏幕下（此时dpr假设为2）200 ×200大小的图片，样式大小也设置为width:200px;,heigth:200px;此时1px像素被4个物理像素点填充。1个位图像素对应了4个物理像素，由于单个位图像素不可以再进一步分割，所以只能就近取色，从而导致图片模糊。(<a href="http://html-js.com/article/MobileWeb" target="_blank" rel="noopener"> </a><a href="http://www.html-js.com/article/Mobile-terminal-H5-mobile-terminal-HD-multi-screen-adaptation-scheme%203041" target="_blank" rel="noopener"> 移动端高清、多屏适配方案</a>,此段内容观点和图片来源于此)</p>
<p><img src="/img/h5adaptat/color.jpg" alt="&#x79FB;&#x52A8;&#x7AEF;&#x9AD8;&#x6E05;&#x3001;&#x591A;&#x5C4F;&#x9002;&#x914D;&#x65B9;&#x6848;"></p>
<p>同理反过来在普通屏幕下（此时dpr假设为1），400 ×400大小的图片，样式大小也设置为width:200px;,heigth:200px;（我们习惯说此时用的2倍图）_。_一个物理像素点对应4个位图像素点，所以它的取色也只能通过一定的算法得到，显示结果就是一张只有原图像素总数四分之一的图，（我们称这个过程叫做downsampling）肉眼看上去图片不会模糊，但是会觉得图片缺少一些锐利度，或者是有点色差。</p>
<p><strong>1px 物理像素边框问题：</strong>在页面不设置放缩的情况下是很难实现的。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/img/h5adaptat/2018-08-03_013838.png" alt=""></p>
<p>如图1倍屏，2倍屏，3倍屏，需要实现1px 物理像素边框border: 1px;，border: 0.5px；border: 0.33px; 然而有的浏览器并不能识别0.5px，0.33px。</p>
<h2 id="3-移动端页面适配的简单解决"><a href="#3-移动端页面适配的简单解决" class="headerlink" title="3.移动端页面适配的简单解决"></a>3.移动端页面适配的简单解决</h2><p>一些Relative lengths，rem,em vw,vh……此处用到了 rem ，rem的官方定义来一下~~（<a href="https://www.w3.org/TR/css3-values/#rem" target="_blank" rel="noopener">https://www.w3.org/TR/css3-values/#rem</a>）<strong>相对于根元素(即html元素)font-size计算值的倍数</strong>。</p>
<p><img src="/img/h5adaptat/2018-08-03_153716.png" alt=""></p>
<p>举个例子，如果页面的html的<strong>font-size</strong> 设置 为 20px,那么 1rem= 20px;</p>
<p>再举个例子：以iPhone6的设计稿为为基础来计算（因为我家设计师喜欢出iPhone6的稿子）</p>
<table>
<thead>
<tr>
<th style="text-align:left">设 备</th>
<th style="text-align:left">设备宽度</th>
<th style="text-align:left">根元素font-size/px</th>
<th style="text-align:left">屏幕宽</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">iPhone5</td>
<td style="text-align:left">320</td>
<td style="text-align:left">17.066（约等于）</td>
<td style="text-align:left">18.75rem</td>
</tr>
<tr>
<td style="text-align:left">(baseWidth)iPhone6</td>
<td style="text-align:left">375</td>
<td style="text-align:left">20</td>
<td style="text-align:left">18.75rem</td>
</tr>
<tr>
<td style="text-align:left">iPhone6 Plus</td>
<td style="text-align:left">414</td>
<td style="text-align:left">22.080（约等于）</td>
<td style="text-align:left">18.75rem</td>
</tr>
</tbody>
</table>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//假设屏幕屏幕宽度 等于布局宽度 等于可视窗口宽度。</span><br><span class="line">// iPhone6 (18.75份是随便取的)</span><br><span class="line">以iPhone6为基础，屏幕宽度为375px，将屏幕宽度分成18.75份，每一份宽度为20px;</span><br><span class="line">设置html的font-size 为20px; 1rem = 20px;</span><br><span class="line">// iPhone5</span><br><span class="line">iPhon5，屏幕宽度为320px，将屏幕宽度分成18.75份，每一份宽度为17.066;</span><br><span class="line">设置html的font-size 为17.066; 1rem 约等于 17.066;</span><br><span class="line"></span><br><span class="line">以iphonp6的设计稿某div的高为20xp 宽为20px 写了一个样式</span><br><span class="line">.haha &#123;</span><br><span class="line">    width: 1rem;  /* iphonp6 下显示为20px */;</span><br><span class="line">    height: 1rem; /* iphonp6 下显示为20px */</span><br><span class="line">&#125;</span><br><span class="line">//上述那段css在iPhone5下 表达的宽高是多少了</span><br><span class="line">.haha &#123;</span><br><span class="line">    width: 1rem;  /* (320/18.75)px*/;</span><br><span class="line">    height: 1rem; /* (320/18.75)px*/</span><br><span class="line">&#125;</span><br><span class="line">// 看一组数字 320/375 = (320/18.75)/20 屏幕宽度比，等于设计稿图片放缩比。</span><br><span class="line">// 这样设计稿就成比例在不同宽度手机屏幕上面显示了</span><br></pre></td></tr></table></figure>
<p><strong>根元素fontSize公式：width/fontSize = baseWidth/baseFontSize</strong> </p>
<h3 id="3-1媒体查询和rem-适配"><a href="#3-1媒体查询和rem-适配" class="headerlink" title="3.1媒体查询和rem 适配"></a><strong>3.1媒体查询和rem 适配</strong></h3><p>先参考一下 比如微博和京东，咦~~ 用的是媒体查询设置。</p>
<p><img src="/img/h5adaptat/2018-08-03_163731.png" alt=""></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> only screen and (max-width: <span class="number">640px</span>) and (min-width: <span class="number">414px</span>) &#123; </span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">22.08px</span>;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> only screen and (max-width: <span class="number">414px</span>) and (min-width: <span class="number">375px</span>) &#123;</span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">18.75px</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">media</span> only screen and (max-width: <span class="number">375px</span>) &#123;    </span><br><span class="line">    <span class="selector-tag">html</span> &#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">17.066px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 这样不是完全的运用了width/fontSize = baseWidth/baseFontSize 这个公式，只是选了几个宽度区间</span><br><span class="line">// 来设置</span><br></pre></td></tr></table></figure>
<p>相对于根元素(即html元素)的font-size值设置好了，然后就是按照设计稿写代码了，问题来了px单位转换成rem人工计算头有点大（在iPhone6 下面每一个都要除以20 换算出rem单位）。</p>
<p>比推荐的方法有两种一种</p>
<ul>
<li><a href="https://www.npmjs.com/package/px2rem" target="_blank" rel="noopener">px2rem</a> （npm安装）</li>
<li>Sass函数、混合宏功能来实现</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// 方法一  例子从文档上面抄下来的</span><br><span class="line"><span class="selector-class">.selector</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>; <span class="comment">/*no*/</span></span><br><span class="line">&#125;</span><br><span class="line">//转换过后</span><br><span class="line"><span class="selector-class">.selector</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">7.5rem</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span><br><span class="line">&#125;</span><br><span class="line">//方法二</span><br><span class="line">$rem-base: 20px !default; // baseFontSize </span><br><span class="line">@<span class="keyword">function</span> rem($value, $base-value: $rem-base) &#123;</span><br><span class="line">  $value: strip-unit($value) / strip-unit($base-value) * 1rem;</span><br><span class="line">  @if ($value == 0rem) &#123; $value: 0; &#125; // Turn 0rem into 0</span><br><span class="line">  @<span class="keyword">return</span> $value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">function</span> strip-unit($num) &#123;</span><br><span class="line">  @<span class="keyword">return</span> $num / ($num * <span class="number">0</span> + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.haha</span> &#123;</span><br><span class="line">    width: rem(150); //通过 rem($value, $base-value: $rem-base) 计算出来 7.5rem。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>个人更喜欢方法一，因为别人写的UI组件通常用的是px。然后就是字体，字体大小建议不要转rem。</p>
<p>用媒体查询查询的方法就比较要关注手机屏幕宽度了（如果做得细致，还是要针对每个屏幕宽划分区间），且对于图片的问题还是没有解决。</p>
<h3 id="3-2viewport-缩放-rem-布局，js计算"><a href="#3-2viewport-缩放-rem-布局，js计算" class="headerlink" title="3.2viewport 缩放,rem 布局，js计算"></a><strong>3.2viewport 缩放,rem 布局，js计算</strong></h3><p>动态的设置根元素(即html元素)font-size的值，也有两种方式(通常代码在head加载，避免页面重绘)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法一 （iPhone 6尺寸作为设计稿基准）</span></span><br><span class="line"><span class="comment">//document.documentElement.clientWidth /18.75</span></span><br><span class="line"><span class="keyword">var</span> e = (<span class="built_in">document</span>.documentElement.clientWidth / <span class="number">375</span>) *<span class="number">20</span> ;</span><br><span class="line"><span class="built_in">document</span>.documentElement.style.fontSize = e + <span class="string">"px"</span></span><br><span class="line">添加标签到HTML</span><br><span class="line">&lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width,initial-scale=1"</span>&gt;</span><br><span class="line">这样做就使得所有屏幕都是基于iphone6的设计稿等比例显示了</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法二 （iPhone 6尺寸作为设计稿基准）动态写入 viewport 放缩</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> e = (<span class="built_in">document</span>.documentElement.clientWidth / <span class="number">375</span>) *<span class="number">20</span> ;</span><br><span class="line"><span class="built_in">document</span>.documentElement.style.fontSize = e + <span class="string">"px"</span></span><br><span class="line"><span class="keyword">var</span> initScale = <span class="number">1</span> / <span class="built_in">window</span>.devicePixelRatio; <span class="comment">// initScale  = 1/2;</span></span><br><span class="line">viewPortMeta = <span class="built_in">window</span>.document.createElement(<span class="string">"meta"</span>);</span><br><span class="line">viewPortMeta.setAttribute(<span class="string">"name"</span>, <span class="string">"viewport"</span>);</span><br><span class="line">viewPortMeta.setAttribute(<span class="string">"content"</span>, <span class="string">"width=device-width, initial-scale="</span> +</span><br><span class="line">      initScale + <span class="string">", user-scalable=no"</span>);</span><br><span class="line"><span class="comment">//iphone6 的物理像素是 750pt*1334pt</span></span><br><span class="line"><span class="comment">// initScale  = 1/2</span></span><br><span class="line"><span class="comment">// device-width = 375</span></span><br><span class="line"><span class="comment">// 页面可是视口大小 = 750px; 布局视口大小也就等于750px</span></span><br><span class="line"><span class="comment">// 此时一个物理像素 对应 一个css像素  （此时图片模糊问题就解决了）</span></span><br></pre></td></tr></table></figure>
<p>方法一：有1px物理像素问题，和图片问题（网上有众多解决方法可以看看），</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// JS判断是否支持0 .5 px的边框， 是的话， 则加上hairlines的类名。（以iphone6为例）</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.devicePixelRatio &amp;&amp; devicePixelRatio &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> testElem = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</span><br><span class="line">	testElem.style.border = <span class="string">'.5px solid #000'</span>;</span><br><span class="line">	<span class="built_in">document</span>.body.appendChild(testElem);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//当div存在</span></span><br><span class="line">	<span class="keyword">if</span> (testElem.offsetHeight == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">document</span>.querySelector(<span class="string">'html'</span>).classList.add(<span class="string">'hairlines'</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//添加完hairlines类名后，则删除div</span></span><br><span class="line">	<span class="built_in">document</span>.body.removeChild(testElem);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 图片的可以考虑实际位置，加载不同倍数的图片（个人觉得没有必要都用2倍图）</span></span><br><span class="line"><span class="comment">// 很多网站 采用的都是这个方法</span></span><br></pre></td></tr></table></figure>
<p>方法二： <strong>安卓机的dpr神奇</strong>，且部分机型放缩情况怪异，所以通常会在iphone下考虑放缩，安卓选择放弃，安卓机的做法就跟方法一 一样了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//计算 initScale 的修改</span><br><span class="line">dpr = win.devicePixelRatio;</span><br><span class="line">dpr = isIphone ? (dpr &gt;= 3 ? 3 : (dpr &gt;= 2 ? 2 : 1)) : 1;</span><br><span class="line">initScale = 1 / dpr;</span><br></pre></td></tr></table></figure>
<p>方法二：需要注意字体的问题，不建议字体跟着屏幕大小变化。通常用js的方法还会给根元素多加一个类或属性来控制字体显示。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//给&lt;html&gt;元素添加data-dpr属性，并且动态改写data-dpr的值，或者动态写一个dpr的class到根元素上</span><br><span class="line">//eg. &lt;html data-dpr="1" class="dpr1"&gt;</span><br><span class="line">// 动态写dpr的class </span><br><span class="line">@<span class="keyword">mixin</span> font-dpr ($font-size) &#123;</span><br><span class="line">  font-size: $font-size;</span><br><span class="line">  <span class="selector-class">.dpr1</span> &amp; &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: $font-size * <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.dpr2</span> &amp; &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: $font-size * <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.dpr3</span> &amp; &#123;</span><br><span class="line">    <span class="attribute">font-size</span>:  $font-size * <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//动态改写data-dpr的值</span><br><span class="line">@<span class="keyword">mixin</span> font-dpr($font-size)&#123;</span><br><span class="line">  font-size: $font-size;</span><br><span class="line">  <span class="selector-attr">[data-dpr="2"]</span> &amp; &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: $font-size * <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-attr">[data-dpr="3"]</span> &amp; &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: $font-size * <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-3vw适配方案（以后可能的方案）"><a href="#3-3vw适配方案（以后可能的方案）" class="headerlink" title="3.3vw适配方案（以后可能的方案）"></a>3.3vw适配方案（以后可能的方案）</h3><blockquote>
<p>vw unit： Equal to 1% of the width of the initial containing block.</p>
<p>vh unit：Equal to 1% of the height of the initial containing block.</p>
</blockquote>
<p> 1vw = 1%视口宽度，看到这个表达是不是心里面一惊喜，3.2的方法就是将屏幕分成多少份，然后根元素(即html元素)的font-size值，每一份用rem来表示。现在vw的出现就更符合技术需要了因为它自动将视口宽度分成了100份。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//假设屏幕屏幕宽度 等于布局宽度 等于可视窗口宽度。</span><br><span class="line">//iPhone 6尺寸作为设计稿基准</span><br><span class="line">//&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;</span><br><span class="line">// 此时 1vw = 375/100 =3.75px;</span><br><span class="line">// 此时就差将px 转换为 vw了（此处Sass函数举个例子）</span><br><span class="line"></span><br><span class="line">$base_width: 375;</span><br><span class="line">@function pxToVW($px) &#123;</span><br><span class="line">    @return ($px / $base_width) * 100vw;</span><br><span class="line">&#125;</span><br><span class="line">// iPhone 6 设计稿中 某 div 宽度为 75 px 高度 75px 表达如下</span><br><span class="line">.haha &#123;</span><br><span class="line">    width： pxToVW(75); // 20vw</span><br><span class="line">    height: pxToVW(75); // 20vw</span><br><span class="line">&#125;</span><br><span class="line">//上述那段css在iPhone5下 表达的宽高是多少了</span><br><span class="line">.haha &#123;</span><br><span class="line">    width： pxToVW(75); // 20vw   320/100*20 = 64px</span><br><span class="line">    height: pxToVW(75); // 20vw   320/100*20 = 64px</span><br><span class="line">&#125;</span><br><span class="line">// 看下数字题 64/75 = 320/375  设计稿在屏幕上的显示等比放缩了</span><br></pre></td></tr></table></figure>
<p>vw好用,但它还存在兼容性问题，可以通过这个网站查阅 <a href="https://caniuse.com/#search=vw" target="_blank" rel="noopener">Can I use</a>。不过也有大神写了文章介绍怎么在实际项目去使用vw。</p>
<h2 id="4-小结"><a href="#4-小结" class="headerlink" title="4.小结"></a>4.小结</h2><p>文中例子比较粗糙，理解不准确之处，还请教正。关于移动端适配部分方法，本文也是描述基础思想原理，还有很多细节，兼容问题没有提及，要真的去理解它，还需多看文档，代码实践。</p>
<p>终于写完了，没写之前和写了之后认知看法又不一样了。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.1" async></script><a class="article-share-link" data-url="blog.bobgao.cn/mobile-adaptation/" data-id="cjnzns0pp001fskdfvnedc7km" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAAByElEQVR42u3aO3LDMAwFQN//0krrIpEfAJLWZJaVx5bMlQoM8Xm94nW9rfdv7q/568r77xcsXFzcMfe6XTkl/5/evbi4uOe594Em32ZyTRTscHFxH8lNjjh5yMPFxf1P3CSBuafj4uI+nztPWvI6xqFcDRcXd8DNq5T7Pm+p7+Li4ra4V3EliVCe5JR3x8XFPcLNA8r9gWPSaCnvi4uLu5mbBJ18m+r4RX6oKtRccXFxx9xemaOXleQvpRB3cXFxN3CTkLRqtCJPosppDy4u7gZufpS5WqtXEPnlkXBxcR/ArY5b5e3V6hgHLi7ut7jVDdY2aBMPLi7uGW5vwCJvmVTLLoVBDVxc3M3cyc3Vwmi1+frhveLi4m7m9kokvYbKZNQDFxf3JDcPbXnK1HuAD0ciXFzcg9y8JNFrnCTlj8JgFi4u7pe41XNF3pKpDmtGgQwXF3cRtzdIkbdXeyWV0WQoLi7umFttlPb+tFqQXbAvLi7umFtNZqqN2DyJin7FxcU9yJ0Hmh66mavh4uI+kpsEoEnhtdBkxcXFfQy3WiKpjl9sibu4uLiDVko+SNELar2EChcX9yR3ElzyQmfeROmlTLi4uIu4PzUfAS89yXMNAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/移动端/">移动端</a></div><div class="post-nav"><a class="pre" href="/vue-observer-subscriber/">讲讲观察vue观察者，订阅者</a><a class="next" href="/promise/">Promise</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'OtBSbVyl8MJtJib4wdwKRilp-gzGzoHsz',
  appKey:'AUvU6SxoIN1aVctrUXCPp5p9',
  placeholder:'Just so so',
  avatar:'mm',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Bob/">Bob</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dawn/">Dawn</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Emfan/">Emfan</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Evel/">Evel</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Little/">Little</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ring/">Ring</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Xiaobu/">Xiaobu</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/JS/" style="font-size: 15px;">JS</a> <a href="/tags/CSS/" style="font-size: 15px;">CSS</a> <a href="/tags/Angular/" style="font-size: 15px;">Angular</a> <a href="/tags/前端自动化/" style="font-size: 15px;">前端自动化</a> <a href="/tags/移动端/" style="font-size: 15px;">移动端</a> <a href="/tags/Node/" style="font-size: 15px;">Node</a> <a href="/tags/微信/" style="font-size: 15px;">微信</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/ab-test/">如何使用ab做接口压力测试</a></li><li class="post-list-item"><a class="post-list-link" href="/Javascript-unit-test/">Javascript单元测试及接口测试</a></li><li class="post-list-item"><a class="post-list-link" href="/how-to-use-JSArray/">如何在 JavaScript 中更好地使用数组</a></li><li class="post-list-item"><a class="post-list-link" href="/hybrid-jian-dan-liao-jie/">hybrid简单了解</a></li><li class="post-list-item"><a class="post-list-link" href="/Async/">Async</a></li><li class="post-list-item"><a class="post-list-link" href="/node mysql pool/">Node 中 mysql 应用 -- 连接池的优势</a></li><li class="post-list-item"><a class="post-list-link" href="/vue-observer-subscriber/">讲讲观察vue观察者，订阅者</a></li><li class="post-list-item"><a class="post-list-link" href="/mobile-adaptation/">移动端web页面适配小结</a></li><li class="post-list-item"><a class="post-list-link" href="/promise/">Promise</a></li><li class="post-list-item"><a class="post-list-link" href="/eventLoop/">浏览器与Node环境下的EventLoop</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://github.com/comeonbob/weShare/tree/develop" title="github" target="_blank">github</a><ul></ul><a href="https://blog.csdn.net/bob_baobao" title="Bob的个人博客" target="_blank">Bob的个人博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">We Share.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.1" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.1" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.1"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = '//hm.baidu.com/hm.js?' + '54010f4a3b1de3d0b50872a92210cec8';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.1"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.1"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":246},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>